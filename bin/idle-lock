#!/bin/bash
# Requires `sudo aura -Aa xidlehook`

killall xidlehook

if [[ "$(hostname)" == "kanade" ]]; then
  xidlehook \
    `# Don't lock when there's a fullscreen application` \
    --not-when-fullscreen \
    `# Don't lock when there's audio playing` \
    --not-when-audio \
    `# Lock after 5 minutes (same as dpms screen blank setting)` \
    --timer normal 300 \
      '/home/jack/bin/screen-lock' \
      ''
fi

if [[ "$(hostname)" == "sinon" ]]; then
  xidlehook \
    `# Don't lock when there's a fullscreen application` \
    --not-when-fullscreen \
    `# Don't lock when there's audio playing` \
    --not-when-audio \
    `# Dim the screen after 60 seconds, undim if user becomes active` \
    --timer normal 60 \
      'light -O; light -S 1' \
      'light -I' \
    `# lock the screen after 3 minutes` \
    --timer primary 180 \
      'light -I; sleep 1; /home/jack/bin/screen-lock' \
      '' \
    `# Undim and suspend (with lock) after 4 more minutes (same as dpms screen blank setting)` \
    --timer normal 60 \
      'sleep 1; systemctl suspend' \
      ''
fi
