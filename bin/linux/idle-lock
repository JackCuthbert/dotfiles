#!/bin/bash
# Requires `sudo aura -Aa xidlehook`

killall xidlehook

if [[ "$(hostname)" == "war-machine" ]]; then
  xidlehook \
    `# Don't lock when there's a fullscreen application` \
    --not-when-fullscreen \
    `# Don't lock when there's audio playing` \
    --not-when-audio \
    `# Lock after 5 minutes` \
    --timer primary 300 \
      '/home/jack/bin/screen-lock' \
      ''
fi

if [[ "$(hostname)" == "pepper" ]]; then
  xidlehook \
    `# Don't lock when there's a fullscreen application` \
    --not-when-fullscreen \
    `# Don't lock when there's audio playing` \
    --not-when-audio \
    `# Dim the screen after 60 seconds, undim if user becomes active` \
    --timer normal 60 \
      'light -O && light -S 1' \
      'light -I' \
    `# Undim & lock after 5 more minutes` \
    --timer primary 300 \
      'light -I && /home/jack/bin/screen-lock' \
      '' \
    `# Finally, suspend half an hour after it locks` \
    --timer normal 1800 \
      'systemctl suspend' \
      ''
fi
